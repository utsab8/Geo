{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GeoSurveyPro - Settings</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="{% static 'admindashboard/dashboard.css' %}" rel="stylesheet">
    <style>
        .settings-card {
            transition: all 0.3s ease;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
            background: var(--card-bg);
        }
        
        .settings-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
            border-color: var(--primary-color);
        }
        
        .setting-item {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            transition: background-color 0.3s ease;
        }
        
        .setting-item:hover {
            background-color: var(--light-bg);
        }
        
        .setting-item:last-child {
            border-bottom: none;
        }
        
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: var(--primary-color);
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        .color-picker {
            width: 50px;
            height: 50px;
            border: 2px solid var(--border-color);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .color-picker:hover {
            border-color: var(--primary-color);
            transform: scale(1.05);
        }
        
        .backup-schedule {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border: 1px solid var(--warning-color);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .security-settings {
            background: linear-gradient(135deg, #dbeafe, #bfdbfe);
            border: 1px solid #2563eb;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <nav class="col-md-3 col-lg-2 d-md-block bg-dark sidebar">
                <div class="position-sticky pt-3">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'admin_dashboard' %}">
                                <i class="fas fa-tachometer-alt"></i> Dashboard
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'admin-users' %}">
                                <i class="fas fa-users"></i> Users
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'admin-survey' %}">
                                <i class="fas fa-file-alt"></i> Surveys
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'admin-system' %}">
                                <i class="fas fa-cogs"></i> System
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="{% url 'admin-settings' %}">
                                <i class="fas fa-sliders-h me-2"></i>
                                Settings
                            </a>
                        </li>
                        <li class="nav-item mt-4">
                            <a class="nav-link text-danger" href="{% url 'logout' %}">
                                <i class="fas fa-sign-out-alt me-2"></i>
                                Logout
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- Main content -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">System Settings</h1>
                    <div class="btn-toolbar mb-2 mb-md-0">
                        <div class="btn-group me-2">
                            <button type="button" class="btn btn-sm btn-outline-secondary" onclick="resetSettings()">
                                <i class="fas fa-undo"></i> Reset
                            </button>
                            <button type="button" class="btn btn-sm btn-primary" onclick="saveAllSettings()">
                                <i class="fas fa-save"></i> Save All
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Settings Navigation -->
                <ul class="nav nav-tabs mb-4" id="settingsTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="general-tab" data-bs-toggle="tab" data-bs-target="#general" type="button" role="tab">
                            <i class="fas fa-cog me-2"></i>General
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="security-tab" data-bs-toggle="tab" data-bs-target="#security" type="button" role="tab">
                            <i class="fas fa-shield-alt me-2"></i>Security
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="backup-tab" data-bs-toggle="tab" data-bs-target="#backup" type="button" role="tab">
                            <i class="fas fa-database me-2"></i>Backup
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="notifications-tab" data-bs-toggle="tab" data-bs-target="#notifications" type="button" role="tab">
                            <i class="fas fa-bell me-2"></i>Notifications
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="appearance-tab" data-bs-toggle="tab" data-bs-target="#appearance" type="button" role="tab">
                            <i class="fas fa-palette me-2"></i>Appearance
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="advanced-tab" data-bs-toggle="tab" data-bs-target="#advanced" type="button" role="tab">
                            <i class="fas fa-cogs me-2"></i>Advanced
                        </button>
                    </li>
                </ul>

                <!-- Settings Content -->
                <div class="tab-content" id="settingsContent">
                    <!-- General Settings -->
                    <div class="tab-pane fade show active" id="general" role="tabpanel">
                        <div class="card settings-card">
                            <div class="card-header">
                                <h5 class="mb-0"><i class="fas fa-cog me-2"></i>General Settings</h5>
                            </div>
                            <div class="card-body p-0">
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Site Name</h6>
                                            <p class="text-muted mb-0">The name of your application</p>
                                        </div>
                                        <div class="col-md-4">
                                            <input type="text" class="form-control" id="siteName" value="GeoSurveyPro">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Site Description</h6>
                                            <p class="text-muted mb-0">Brief description of your application</p>
                                        </div>
                                        <div class="col-md-4">
                                            <textarea class="form-control" id="siteDescription" rows="2">Advanced Geospatial Survey Management System</textarea>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Time Zone</h6>
                                            <p class="text-muted mb-0">Default timezone for the application</p>
                                        </div>
                                        <div class="col-md-4">
                                            <select class="form-select" id="timezone">
                                                <option value="UTC">UTC</option>
                                                <option value="EST">Eastern Time</option>
                                                <option value="PST">Pacific Time</option>
                                                <option value="GMT">GMT</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Maintenance Mode</h6>
                                            <p class="text-muted mb-0">Enable maintenance mode to restrict access</p>
                                        </div>
                                        <div class="col-md-4">
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="maintenanceMode">
                                                <span class="slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Debug Mode</h6>
                                            <p class="text-muted mb-0">Enable debug mode for development</p>
                                        </div>
                                        <div class="col-md-4">
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="debugMode">
                                                <span class="slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Max File Size (MB)</h6>
                                            <p class="text-muted mb-0">Maximum file size allowed for uploads</p>
                                        </div>
                                        <div class="col-md-4">
                                            <input type="number" class="form-control" id="maxFileSize" value="10" min="1" max="100">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Allowed File Types</h6>
                                            <p class="text-muted mb-0">Comma-separated list of allowed file extensions</p>
                                        </div>
                                        <div class="col-md-4">
                                            <input type="text" class="form-control" id="allowedFileTypes" value="kml,csv,shp,zip">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Auto Process Files</h6>
                                            <p class="text-muted mb-0">Automatically process uploaded files</p>
                                        </div>
                                        <div class="col-md-4">
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="autoProcessFiles" checked>
                                                <span class="slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Enable Analytics</h6>
                                            <p class="text-muted mb-0">Enable user analytics and tracking</p>
                                        </div>
                                        <div class="col-md-4">
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="enableAnalytics" checked>
                                                <span class="slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Enable Logging</h6>
                                            <p class="text-muted mb-0">Enable system logging and activity tracking</p>
                                        </div>
                                        <div class="col-md-4">
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="enableLogging" checked>
                                                <span class="slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Log Retention (days)</h6>
                                            <p class="text-muted mb-0">How long to keep log files</p>
                                        </div>
                                        <div class="col-md-4">
                                            <input type="number" class="form-control" id="logRetentionDays" value="30" min="1" max="365">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Security Settings -->
                    <div class="tab-pane fade" id="security" role="tabpanel">
                        <div class="security-settings">
                            <h5><i class="fas fa-shield-alt me-2"></i>Security Configuration</h5>
                            <p class="text-muted">Configure security settings for your application</p>
                        </div>
                        
                        <div class="card settings-card">
                            <div class="card-body p-0">
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Two-Factor Authentication</h6>
                                            <p class="text-muted mb-0">Require 2FA for all users</p>
                                        </div>
                                        <div class="col-md-4">
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="twoFactorAuth">
                                                <span class="slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Session Timeout (minutes)</h6>
                                            <p class="text-muted mb-0">Auto-logout after inactivity</p>
                                        </div>
                                        <div class="col-md-4">
                                            <input type="number" class="form-control" id="sessionTimeout" value="30" min="5" max="480">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Password Complexity</h6>
                                            <p class="text-muted mb-0">Minimum password requirements</p>
                                        </div>
                                        <div class="col-md-4">
                                            <select class="form-select" id="passwordComplexity">
                                                <option value="low">Low (6 characters)</option>
                                                <option value="medium" selected>Medium (8 characters, mixed)</option>
                                                <option value="high">High (10 characters, special chars)</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">IP Whitelist</h6>
                                            <p class="text-muted mb-0">Restrict access to specific IP addresses</p>
                                        </div>
                                        <div class="col-md-4">
                                            <textarea class="form-control" id="ipWhitelist" rows="3" placeholder="Enter IP addresses (one per line)"></textarea>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Rate Limiting</h6>
                                            <p class="text-muted mb-0">Limit API requests per minute</p>
                                        </div>
                                        <div class="col-md-4">
                                            <input type="number" class="form-control" id="rateLimit" value="100" min="10" max="1000">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Backup Settings -->
                    <div class="tab-pane fade" id="backup" role="tabpanel">
                        <div class="backup-schedule">
                            <h5><i class="fas fa-database me-2"></i>Backup Configuration</h5>
                            <p class="text-muted">Configure automatic backup settings</p>
                        </div>
                        
                        <div class="card settings-card">
                            <div class="card-body p-0">
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Auto Backup</h6>
                                            <p class="text-muted mb-0">Enable automatic database backups</p>
                                        </div>
                                        <div class="col-md-4">
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="autoBackup" checked>
                                                <span class="slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Backup Frequency</h6>
                                            <p class="text-muted mb-0">How often to create backups</p>
                                        </div>
                                        <div class="col-md-4">
                                            <select class="form-select" id="backupFrequency">
                                                <option value="daily">Daily</option>
                                                <option value="weekly" selected>Weekly</option>
                                                <option value="monthly">Monthly</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Retention Period (days)</h6>
                                            <p class="text-muted mb-0">How long to keep backups</p>
                                        </div>
                                        <div class="col-md-4">
                                            <input type="number" class="form-control" id="backupRetention" value="30" min="1" max="365">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Backup Location</h6>
                                            <p class="text-muted mb-0">Where to store backups</p>
                                        </div>
                                        <div class="col-md-4">
                                            <input type="text" class="form-control" id="backupLocation" value="/backups/">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Compress Backups</h6>
                                            <p class="text-muted mb-0">Compress backup files to save space</p>
                                        </div>
                                        <div class="col-md-4">
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="compressBackups" checked>
                                                <span class="slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Notification Settings -->
                    <div class="tab-pane fade" id="notifications" role="tabpanel">
                        <div class="card settings-card">
                            <div class="card-header">
                                <h5 class="mb-0"><i class="fas fa-bell me-2"></i>Notification Settings</h5>
                            </div>
                            <div class="card-body p-0">
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Email Notifications</h6>
                                            <p class="text-muted mb-0">Send notifications via email</p>
                                        </div>
                                        <div class="col-md-4">
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="emailNotifications" checked>
                                                <span class="slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">System Alerts</h6>
                                            <p class="text-muted mb-0">Receive system error alerts</p>
                                        </div>
                                        <div class="col-md-4">
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="systemAlerts" checked>
                                                <span class="slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">User Activity</h6>
                                            <p class="text-muted mb-0">Notify about user activities</p>
                                        </div>
                                        <div class="col-md-4">
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="userActivityNotifications">
                                                <span class="slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Admin Email</h6>
                                            <p class="text-muted mb-0">Email address for admin notifications</p>
                                        </div>
                                        <div class="col-md-4">
                                            <input type="email" class="form-control" id="adminEmail" value="admin@geosurveypro.com">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Appearance Settings -->
                    <div class="tab-pane fade" id="appearance" role="tabpanel">
                        <div class="card settings-card">
                            <div class="card-header">
                                <h5 class="mb-0"><i class="fas fa-palette me-2"></i>Appearance Settings</h5>
                            </div>
                            <div class="card-body p-0">
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Theme</h6>
                                            <p class="text-muted mb-0">Choose application theme</p>
                                        </div>
                                        <div class="col-md-4">
                                            <select class="form-select" id="theme">
                                                <option value="light" selected>Light</option>
                                                <option value="dark">Dark</option>
                                                <option value="auto">Auto</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Primary Color</h6>
                                            <p class="text-muted mb-0">Main application color</p>
                                        </div>
                                        <div class="col-md-4">
                                            <input type="color" class="color-picker" id="primaryColor" value="#2563eb">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Sidebar Position</h6>
                                            <p class="text-muted mb-0">Position of the navigation sidebar</p>
                                        </div>
                                        <div class="col-md-4">
                                            <select class="form-select" id="sidebarPosition">
                                                <option value="left" selected>Left</option>
                                                <option value="right">Right</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Compact Mode</h6>
                                            <p class="text-muted mb-0">Use compact layout for better space usage</p>
                                        </div>
                                        <div class="col-md-4">
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="compactMode">
                                                <span class="slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Advanced Settings -->
                    <div class="tab-pane fade" id="advanced" role="tabpanel">
                        <div class="card settings-card">
                            <div class="card-header">
                                <h5 class="mb-0"><i class="fas fa-cogs me-2"></i>Advanced Settings</h5>
                            </div>
                            <div class="card-body p-0">
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">SMTP Host</h6>
                                            <p class="text-muted mb-0">SMTP server for email notifications</p>
                                        </div>
                                        <div class="col-md-4">
                                            <input type="text" class="form-control" id="smtpHost" placeholder="smtp.gmail.com">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">SMTP Port</h6>
                                            <p class="text-muted mb-0">SMTP server port</p>
                                        </div>
                                        <div class="col-md-4">
                                            <input type="number" class="form-control" id="smtpPort" value="587" min="1" max="65535">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">SMTP Username</h6>
                                            <p class="text-muted mb-0">SMTP authentication username</p>
                                        </div>
                                        <div class="col-md-4">
                                            <input type="text" class="form-control" id="smtpUsername" placeholder="your-email@gmail.com">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">SMTP Password</h6>
                                            <p class="text-muted mb-0">SMTP authentication password</p>
                                        </div>
                                        <div class="col-md-4">
                                            <input type="password" class="form-control" id="smtpPassword" placeholder="Enter password">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Use TLS</h6>
                                            <p class="text-muted mb-0">Enable TLS encryption for SMTP</p>
                                        </div>
                                        <div class="col-md-4">
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="smtpUseTLS" checked>
                                                <span class="slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">From Email</h6>
                                            <p class="text-muted mb-0">Default sender email address</p>
                                        </div>
                                        <div class="col-md-4">
                                            <input type="email" class="form-control" id="fromEmail" value="noreply@geosurveypro.com">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">API Rate Limit</h6>
                                            <p class="text-muted mb-0">Maximum API requests per minute</p>
                                        </div>
                                        <div class="col-md-4">
                                            <input type="number" class="form-control" id="apiRateLimit" value="1000" min="10" max="10000">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">API Key Expiration (days)</h6>
                                            <p class="text-muted mb-0">How long API keys remain valid</p>
                                        </div>
                                        <div class="col-md-4">
                                            <input type="number" class="form-control" id="apiKeyExpiration" value="30" min="1" max="365">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Enable API Access</h6>
                                            <p class="text-muted mb-0">Allow API access to the system</p>
                                        </div>
                                        <div class="col-md-4">
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="enableAPIAccess" checked>
                                                <span class="slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Require API Key</h6>
                                            <p class="text-muted mb-0">Require API key for all API requests</p>
                                        </div>
                                        <div class="col-md-4">
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="requireAPIKey">
                                                <span class="slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Max Login Attempts</h6>
                                            <p class="text-muted mb-0">Maximum failed login attempts before lockout</p>
                                        </div>
                                        <div class="col-md-4">
                                            <input type="number" class="form-control" id="maxLoginAttempts" value="5" min="1" max="20">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Lockout Duration (minutes)</h6>
                                            <p class="text-muted mb-0">How long to lock out after failed attempts</p>
                                        </div>
                                        <div class="col-md-4">
                                            <input type="number" class="form-control" id="lockoutDuration" value="15" min="1" max="1440">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Password Expiration (days)</h6>
                                            <p class="text-muted mb-0">How often users must change passwords</p>
                                        </div>
                                        <div class="col-md-4">
                                            <input type="number" class="form-control" id="passwordExpirationDays" value="90" min="0" max="365">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Max Processing Time (seconds)</h6>
                                            <p class="text-muted mb-0">Maximum time for file processing</p>
                                        </div>
                                        <div class="col-md-4">
                                            <input type="number" class="form-control" id="maxProcessingTime" value="300" min="30" max="3600">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Max Parallel Jobs</h6>
                                            <p class="text-muted mb-0">Maximum concurrent processing jobs</p>
                                        </div>
                                        <div class="col-md-4">
                                            <input type="number" class="form-control" id="maxParallelJobs" value="4" min="1" max="20">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Storage Path</h6>
                                            <p class="text-muted mb-0">Path for file storage</p>
                                        </div>
                                        <div class="col-md-4">
                                            <input type="text" class="form-control" id="storagePath" value="/uploads/">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Max Storage Quota (MB)</h6>
                                            <p class="text-muted mb-0">Maximum storage per user</p>
                                        </div>
                                        <div class="col-md-4">
                                            <input type="number" class="form-control" id="maxStorageQuota" value="1024" min="10" max="10000">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Enable Storage Quota</h6>
                                            <p class="text-muted mb-0">Enforce storage limits per user</p>
                                        </div>
                                        <div class="col-md-4">
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="enableStorageQuota" checked>
                                                <span class="slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Monitoring Interval (seconds)</h6>
                                            <p class="text-muted mb-0">How often to collect system metrics</p>
                                        </div>
                                        <div class="col-md-4">
                                            <input type="number" class="form-control" id="monitoringInterval" value="60" min="10" max="3600">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Maintenance Time</h6>
                                            <p class="text-muted mb-0">Time for scheduled maintenance (24h format)</p>
                                        </div>
                                        <div class="col-md-4">
                                            <input type="time" class="form-control" id="maintenanceTime" value="02:00">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <h6 class="mb-1">Cleanup Retention (days)</h6>
                                            <p class="text-muted mb-0">How long to keep old data before cleanup</p>
                                        </div>
                                        <div class="col-md-4">
                                            <input type="number" class="form-control" id="cleanupRetentionDays" value="90" min="1" max="365">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JavaScript -->
    <script>
        // Initialize settings page
        document.addEventListener('DOMContentLoaded', function() {
            loadSettings();
            setupEventListeners();
        });

        function setupEventListeners() {
            // Auto-save on change
            const inputs = document.querySelectorAll('input, select, textarea');
            inputs.forEach(input => {
                input.addEventListener('change', function() {
                    saveSetting(this.id, this.value, this.type === 'checkbox' ? this.checked : this.value);
                });
            });
        }

        function loadSettings() {
            fetch('{% url "admin_api_settings" %}')
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        populateSettings(data.settings);
                    }
                })
                .catch(error => console.error('Error loading settings:', error));
        }

        function populateSettings(settings) {
            // Populate form fields with loaded settings
            Object.keys(settings).forEach(key => {
                const element = document.getElementById(key);
                if (element) {
                    if (element.type === 'checkbox') {
                        element.checked = settings[key];
                    } else {
                        element.value = settings[key];
                    }
                }
            });
        }

        function saveSetting(key, value, actualValue) {
            fetch('{% url "admin_api_settings" %}', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': getCookie('csrftoken')
                },
                body: JSON.stringify({
                    key: key,
                    value: actualValue
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showToast(`Setting "${key}" saved`, 'success');
                } else {
                    showToast(`Error saving "${key}": ${data.message}`, 'error');
                }
            })
            .catch(error => {
                showToast(`Error saving "${key}": ${error.message}`, 'error');
            });
        }

        function saveAllSettings() {
            const settings = {};
            const inputs = document.querySelectorAll('input, select, textarea');
            
            inputs.forEach(input => {
                if (input.type === 'checkbox') {
                    settings[input.id] = input.checked;
                } else {
                    settings[input.id] = input.value;
                }
            });

            fetch('{% url "admin_api_settings" %}', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': getCookie('csrftoken')
                },
                body: JSON.stringify(settings)
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showToast('All settings saved successfully', 'success');
                } else {
                    showToast('Error saving settings: ' + data.message, 'error');
                }
            })
            .catch(error => {
                showToast('Error saving settings: ' + error.message, 'error');
            });
        }

        function resetSettings() {
            if (confirm('Are you sure you want to reset all settings to default values?')) {
                fetch('{% url "admin_api_settings" %}', {
                    method: 'DELETE',
                    headers: {
                        'X-CSRFToken': getCookie('csrftoken')
                    }
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        showToast('Settings reset to defaults', 'success');
                        loadSettings();
                    } else {
                        showToast('Error resetting settings: ' + data.message, 'error');
                    }
                })
                .catch(error => {
                    showToast('Error resetting settings: ' + error.message, 'error');
                });
            }
        }

        function getCookie(name) {
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }

        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = `alert alert-${type === 'error' ? 'danger' : type} alert-dismissible fade show position-fixed`;
            toast.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
            toast.innerHTML = `
                <div class="d-flex align-items-center">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'} me-2"></i>
                    <span>${message}</span>
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                if (toast.parentNode) {
                    toast.parentNode.removeChild(toast);
                }
            }, 5000);
        }
        
        // Add keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Ctrl/Cmd + S to save all settings
            if ((e.ctrlKey || e.metaKey) && e.key === 's') {
                e.preventDefault();
                saveAllSettings();
            }
            
            // Ctrl/Cmd + R to reset settings
            if ((e.ctrlKey || e.metaKey) && e.key === 'r') {
                e.preventDefault();
                resetSettings();
            }
        });
        
        // Add auto-save indicator
        let autoSaveTimeout;
        function showAutoSaveIndicator() {
            const indicator = document.createElement('div');
            indicator.id = 'autoSaveIndicator';
            indicator.className = 'position-fixed';
            indicator.style.cssText = 'bottom: 20px; right: 20px; z-index: 9999; background: #28a745; color: white; padding: 8px 16px; border-radius: 20px; font-size: 12px;';
            indicator.innerHTML = '<i class="fas fa-save me-2"></i>Auto-saving...';
            
            document.body.appendChild(indicator);
            
            setTimeout(() => {
                if (indicator.parentNode) {
                    indicator.parentNode.removeChild(indicator);
                }
            }, 2000);
        }
        
        // Enhanced auto-save functionality
        function setupAutoSave() {
            const inputs = document.querySelectorAll('input, select, textarea');
            inputs.forEach(input => {
                input.addEventListener('change', function() {
                    clearTimeout(autoSaveTimeout);
                    autoSaveTimeout = setTimeout(() => {
                        saveSetting(this.id, this.value, this.type === 'checkbox' ? this.checked : this.value);
                        showAutoSaveIndicator();
                    }, 1000); // Auto-save after 1 second of inactivity
                });
            });
        }
        
        // Initialize auto-save
        setupAutoSave();
    </script>
</body>
</html>
